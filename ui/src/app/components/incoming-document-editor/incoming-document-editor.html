<form [formGroup]="formGroup" (ngSubmit)="save()">
    <div class="p-dialog" >
        <div class="p-dialog-header">
            <div class="text-xl font-bold">
            @if (incomingDocumentId) {
                Редактирование входящего документа
            } @else {
                Создание входящего документа
            }
            </div>
        </div>
        <div class="p-dialog-content" [style]="{ height: '500px' }">
            <div class="flex flex-col gap-6 w-full sm:w-auto">
                <div class="flex flex-col sm:flex-row sm:items-center gap-6">

                    <div class="flex-auto flex flex-col">
                            <label for="documentDate" class="mb-1 text-left">Дата документа</label>
                            <p-datePicker formControlName="documentDate" id="documentDate"
                                          [showIcon]="true"
                                          [showOnFocus]="false">
                            </p-datePicker>
                    </div>

                    <div class="flex-auto  flex flex-col">
                        <label for="documentNumber" class="mb-1 text-left" >Номер документа</label>
                        <input class="flex" id="documentNumber" pInputText formControlName="documentNumber">
                    </div>

                    <div class="flex-auto flex flex-col">
                        <label for="contractorId" class="mb-1 text-left" >Контрагент</label>
                        <p-autocomplete [forceSelection]="true" formControlName="contractor" [suggestions]="contractors" showClear="true"
                                        (completeMethod)="completeContractors($event)" id="contractorId" fluid placeholder="Выберите контрагента"
                                        (onClear)="clearSelection()" optionLabel="title"
                        >
                            <ng-template let-item #item>
                                {{item.title}}
                            </ng-template>
                        </p-autocomplete>
                    </div>

                    <div class="flex-auto flex flex-col">
                        <label for="contractId" class="mb-1 text-left" >Договор</label>
                        <p-autocomplete [forceSelection]="true" formControlName="contract" [suggestions]="contracts" showClear="true"
                                        (completeMethod)="completeContracts($event)" fluid placeholder="Выберите договор"
                                        (onClear)="clearContractSelection()" optionLabel="title"  id="contractId"
                        >
                            <ng-template let-item #item>
                                {{item.title}}
                            </ng-template>
                        </p-autocomplete>
                    </div>

                    <div class="flex-auto flex flex-col">
                        <label for="warehouseId" class="mb-1 text-left">Склад</label>
                        <input id="warehouseId"
                            pInputText
                            [value]="formGroup.get('warehouse')?.value?.title"
                            readonly
                        />
                    </div>

                </div>
            </div>

            <p-table [value]="tmsItems" [tableStyle]="{ 'min-width': '50rem', 'margin-top': '3rem'  }" [scrollable]="true" scrollHeight="500px" >
                <ng-template #header>
                    <tr>
                        <th>Наименование ТМЦ</th>
                        <th>Кол-во</th>
                        <th>Цена</th>
                        <th>Сумма</th>

                        <th>Actions</th>
                    </tr>
                </ng-template>

                <ng-template #body let-tmcItem>
                    <tr>
                        <td>{{ tmcItem.warehouseItemTypeTitle }}</td>
                        <td>{{ tmcItem.quantity }}</td>
                        <td>{{ tmcItem.price }}</td>
                        <td>{{ calculateSum(tmcItem.quantity, tmcItem.price) }}</td>
                        <p-button icon="pi pi-trash" (onClick)="removeTmcItem()"></p-button>

                    </tr>
                </ng-template>
            </p-table>

            <p-button label="Добавить ТМС запись" icon="pi pi-plus" (click)="addTmcItemDialog()" class="p-mt-2"></p-button>

        </div>


        <div class="p-dialog-footer">
            <p-button label="Сохранить" type="submit"></p-button>
            <p-button label="Отмена" type="button" (onClick)="cancel()"></p-button>
        </div>
    </div>
</form>
